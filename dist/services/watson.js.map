{"version":3,"sources":["../../src/services/watson.js"],"names":["assistant","AssistantV2","version","authenticator","IamAuthenticator","apikey","process","env","API_KEY","url","WATSON_URL","assistantId","ASSISTANT_ID","sessionId","createSession","then","res","result","session_id","deleteSession","sendMessage","message_type","text","user_id","message","input","suggestion_id","toString"],"mappings":";;;;;;kBAGe,YAAY;AACzB,QAAMA,YAAY,IAAIC,WAAJ,CAAgB;AAChCC,aAAS,YADuB;AAEhCC,mBAAe,IAAIC,sBAAJ,CAAqB;AAClCC,cAAQC,QAAQC,GAAR,CAAYC;AADc,KAArB,CAFiB;AAKhCC,SAAKH,QAAQC,GAAR,CAAYG;AALe,GAAhB,CAAlB;;AAQA,QAAMC,cAAcL,QAAQC,GAAR,CAAYK,YAAhC;;AAEA,MAAIC,YAAY,EAAhB;;AAEA,WAASC,aAAT,GAAyB;AACvB,WAAOd,UAAUc,aAAV,CAAwB,EAAEH,WAAF,EAAxB,EACJI,IADI,CACCC,OAAO;AACXH,kBAAYG,IAAIC,MAAJ,CAAWC,UAAvB;AACA,aAAOF,GAAP;AACD,KAJI,CAAP;AAKD;;AAED,WAASG,aAAT,GAAyB;AACvB,WAAOnB,UAAUmB,aAAV,CAAwB,EAAER,WAAF,EAAeE,SAAf,EAAxB,CAAP;AACD;;AAED,WAASO,WAAT,CAAqB,EAAEC,eAAe,MAAjB,EAAyBC,IAAzB,EAA+BC,OAA/B,EAArB,EAA+D;AAC7D,WAAOvB,UAAUwB,OAAV,CAAkB;AACvBb,iBADuB;AAEvBE,eAFuB;AAGvBY,aAAO,EAAEJ,YAAF,EAAgBC,IAAhB,EAAsBI,eAAeH,QAAQI,QAAR,EAArC;AAHgB,KAAlB,CAAP;AAKD;;AAED,SAAO;AACLb,iBADK;AAELK,iBAFK;AAGLC;AAHK,GAAP;AAKD,C;;AAzCD;;;;AACA","file":"watson.js","sourcesContent":["import AssistantV2 from 'ibm-watson/assistant/v2';\nimport { IamAuthenticator } from 'ibm-watson/auth';\n\nexport default function () {\n  const assistant = new AssistantV2({\n    version: '2020-02-05',\n    authenticator: new IamAuthenticator({\n      apikey: process.env.API_KEY,\n    }),\n    url: process.env.WATSON_URL,\n  });\n\n  const assistantId = process.env.ASSISTANT_ID;\n  \n  let sessionId = '';\n\n  function createSession() {\n    return assistant.createSession({ assistantId })\n      .then(res => {\n        sessionId = res.result.session_id;\n        return res;\n      });\n  }\n\n  function deleteSession() {\n    return assistant.deleteSession({ assistantId, sessionId });\n  }\n\n  function sendMessage({ message_type = 'text', text, user_id }) {\n    return assistant.message({\n      assistantId,\n      sessionId,\n      input: { message_type, text, suggestion_id: user_id.toString() },\n    });\n  }\n\n  return {\n    createSession,\n    deleteSession,\n    sendMessage\n  };\n}\n"]}